# 🎯 ETF投资组合回测系统

**完整的投资策略回测、分析和对比系统**

---

## 🚀 快速开始

### 查看交互式报告（推荐）
```bash
open investment_report.html
```

### 查看最终分析报告
```bash
cat FINAL_REPORT.md
```

### 查看40%纳指策略分析
```bash
cat ANALYSIS_40_NASDAQ.md
```

---

## 🏆 终极推荐：40%纳指阈值再平衡策略

**为什么是最优？**
- ✅ 总收益率: **319.63%** (所有策略中最高)
- ✅ 年化收益率: **14.20%** (所有策略中最高)
- ✅ 夏普比率: **0.686** (所有策略中最高)
- ✅ 索提诺比率: **0.880** (所有策略中最高)
- ✅ 回撤可控: -21.35%
- ✅ 操作简单: 7次再平衡（10年）

**策略配置**:
- 纳斯达克100: 40%
- 标普500: 20%
- 中证红利低波100: 20%
- 自由现金流指数: 20%
- 再平衡阈值: 相对20% (纳指8%, 其他4%)

---

## 📊 所有策略概览（共6种）

| 策略 | 收益率 | 年化 | 夏普 | 索提诺 | 回撤 | 操作 |
|------|--------|------|------|--------|------|------|
| **🥇 40%纳指阈值** | **319.63%** | **14.20%** | **0.686** | **0.880** | -21.35% | 7次 |
| 🥈 25%均衡阈值 | 272.56% | 12.95% | 0.628 | 0.800 | -20.34% | 5次 |
| 🥉 25%均衡不平衡 | 272.89% | 12.96% | 0.604 | 0.764 | -22.33% | 0次 |
| 含债阈值 | 239.79% | 11.99% | 0.625 | 0.799 | **-19.51%** | 8次 |
| 含债不平衡 | 250.27% | 12.31% | 0.612 | 0.779 | -20.48% | 0次 |
| 25%定期平衡 | 264.82% | 12.73% | 0.611 | 0.775 | -21.67% | 17次 |

---

## 📁 项目文件说明

### 🎨 报告文档（推荐阅读）

| 文件 | 说明 | 推荐度 |
|------|------|--------|
| `investment_report.html` | 交互式可视化报告 | ⭐⭐⭐⭐⭐ |
| `ANALYSIS_40_NASDAQ.md` | 40%纳指策略详细分析 | ⭐⭐⭐⭐⭐ |
| `FINAL_REPORT.md` | 所有策略完整对比 | ⭐⭐⭐⭐ |
| `REBALANCE_EXPLAINED.md` | 再平衡机制详解 | ⭐⭐⭐⭐ |

### 💻 回测脚本（6个）

| 文件 | 策略 | 配置 |
|------|------|------|
| `backtest_40_nasdaq.py` ⭐ | 40%纳指阈值 | 40/20/20/20 |
| `backtest_threshold_rebalance.py` | 25%均衡阈值 | 25/25/25/25 |
| `backtest.py` | 25%均衡不平衡 | 25/25/25/25 |
| `backtest_with_bond_threshold.py` | 含债阈值 | 22.5/22.5/22.5/22.5/10债 |
| `backtest_with_bond.py` | 含债不平衡 | 22.5/22.5/22.5/22.5/10债 |
| `backtest_rebalance.py` | 25%定期平衡 | 25/25/25/25 |

### 📊 分析工具（4个）

| 文件 | 功能 |
|------|------|
| `calculate_sortino.py` | 计算索提诺比率 |
| `compare_all_strategies.py` | 对比无债策略 |
| `compare_with_bond.py` | 对比含债效果 |
| `generate_html_report.py` | 生成HTML报告 |

### 📈 回测数据（6个CSV文件）

所有策略的每日持仓明细数据（共约3.5MB）

---

## 🎯 使用指南

### 运行最优策略
```bash
cd etf_reblance
source ../venv/bin/activate

# 运行40%纳指策略
python backtest_40_nasdaq.py
```

### 生成完整报告
```bash
# 计算索提诺比率
python calculate_sortino.py

# 生成HTML报告
python generate_html_report.py

# 在浏览器中查看
open investment_report.html
```

---

## 💡 核心概念解释

### 什么是夏普比率？
**公式**: (年化收益 - 3%) / 总波动率  
**意义**: 每承受1单位**总风险**，能赚多少超额收益  
**数值**: 越高越好，通常>0.5就很优秀

### 什么是索提诺比率？⭐
**公式**: (年化收益 - 3%) / 下行波动率  
**意义**: 每承受1单位**亏损风险**，能赚多少超额收益  
**优势**: 只惩罚下跌风险，不惩罚上涨波动  
**数值**: 通常比夏普比率高20-30%

### 什么是相对阈值？
不同权重的资产使用不同的阈值：
- 40%资产: 阈值 = 40% × 20% = 8%
- 20%资产: 阈值 = 20% × 20% = 4%

更合理，更高效！

---

## 📖 阅读建议

### 新手路径
1. 📊 `investment_report.html` - 先看可视化总览
2. 📝 `FINAL_REPORT.md` - 了解所有策略
3. 🚀 `ANALYSIS_40_NASDAQ.md` - 重点看最优策略
4. 🔄 `REBALANCE_EXPLAINED.md` - 深入理解再平衡

### 进阶路径
1. 💻 阅读回测脚本源码
2. 🔧 修改参数进行自定义回测
3. 📊 分析CSV数据文件
4. 🎨 自定义HTML报告样式

---

## ⚠️ 重要提示

### 历史业绩不代表未来

**2015-2025是美股科技股黄金十年**:
- 纳指涨幅527.74%
- 这种涨幅可能难以重复
- 未来可能需要调整配置

### 实际投资考虑

1. **交易成本**: 每次再平衡有手续费
2. **税费**: 卖出盈利资产需要缴税
3. **滑点**: 大额交易可能有价格影响
4. **汇率**: 美股投资受汇率影响

### 建议

- ✅ 把回测结果作为参考，不是绝对
- ✅ 定期评估市场环境
- ✅ 根据实际情况调整配置
- ✅ 坚持长期投资

---

## 🎓 项目成果

- ✅ **6种完整策略**实现
- ✅ **3份详细报告**分析
- ✅ **1个交互式HTML**可视化
- ✅ **4个对比工具**深度分析
- ✅ **10次Git提交**记录演进
- ✅ **3000+行代码**稳定可靠

---

## 📞 文件导航

```
etf_reblance/
│
├── 📊 报告（必读）
│   ├── investment_report.html ⭐⭐⭐⭐⭐
│   ├── ANALYSIS_40_NASDAQ.md ⭐⭐⭐⭐⭐
│   ├── FINAL_REPORT.md ⭐⭐⭐⭐
│   └── REBALANCE_EXPLAINED.md ⭐⭐⭐⭐
│
├── 💻 回测脚本
│   ├── backtest_40_nasdaq.py (最优)
│   ├── backtest_threshold_rebalance.py
│   ├── backtest_with_bond_threshold.py
│   └── ... (其他3个)
│
├── 🔧 分析工具
│   ├── calculate_sortino.py
│   ├── generate_html_report.py
│   └── ... (其他2个)
│
└── 📈 回测数据
    └── 6个CSV文件
```

---

## 🎉 项目亮点

1. **完整的策略矩阵**: 从保守到激进，应有尽有
2. **科学的指标体系**: 夏普、索提诺、回撤、波动率
3. **直观的可视化**: 交互式HTML + 动态图表
4. **详细的文档**: 原理、代码、案例全覆盖
5. **可复现的结果**: 所有代码开源，数据完整

---

**Happy Investing! 📈💰**

